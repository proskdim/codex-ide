<div
  class="fixed inset-0 z-50 flex items-center justify-center bg-black/65 backdrop-blur p-4 animate-fade-in"
>
  <div
    class="w-full h-full md:w-[98vw] md:h-[95vh] max-w-[1500px] flex flex-col text-gray-900 font-sans rounded-xl shadow-xl overflow-hidden border border-gray-200 relative animate-scale-up bg-[#f5f6fa]"
  >
    <nav
      class="h-14 border-b border-[#e3e7ed] bg-white flex items-center justify-between px-6 shrink-0 relative z-20 select-none rounded-t-xl"
    >
      <div class="flex items-center space-x-2">
        <button
          (click)="onCloseEditor()"
          aria-label="Close editor"
          class="flex items-center text-[#999faf] hover:text-white hover:bg-red-500 px-2 py-1 rounded transition-all cursor-pointer"
        >
          <span>X</span>
        </button>
      </div>

      <div class="flex items-center">
        <button
          (click)="submitCode()"
          class="bg-[#21be72] hover:bg-[#23ce7f] text-white px-6 py-2 rounded font-semibold text-sm shadow transition-all"
        >
          Submit
        </button>
      </div>
    </nav>

    <main class="flex-1 overflow-hidden relative z-10 p-2">
      <as-split direction="horizontal" (dragEnd)="onSplitDragEnd()" [gutterSize]="8">
        <!-- Description Section -->
        <as-split-area [size]="mainSplitSizes[0]" [minSize]="4">
          <section class="flex flex-col h-full bg-[#fafbfc] border border-[#e3e7ed] rounded-xl overflow-hidden">
            <div class="flex bg-[#f7f8fa] border-b border-[#e3e7ed] text-sm font-semibold shrink-0 items-center justify-between pr-2">
              <span class="px-5 py-2 text-[#293146] flex items-center gap-2 tracking-wide" [class.hidden]="isDescriptionCollapsed()">
                Description
              </span>
              <button
                (click)="toggleDescription()"
                class="p-1 hover:bg-gray-200 rounded transition-colors cursor-pointer text-gray-500"
                [title]="isDescriptionCollapsed() ? 'Expand' : 'Collapse'"
              >
                <span class="text-lg">{{ isDescriptionCollapsed() ? '→' : '←' }}</span>
              </button>
            </div>
            <div
              *ngIf="!isDescriptionCollapsed()"
              class="flex-1 overflow-y-auto p-6 custom-scrollbar text-[#293146] leading-relaxed"
            >
              <markdown [data]="description" class="prose prose-sm max-w-none"></markdown>
            </div>
            <div *ngIf="isDescriptionCollapsed()" class="flex-1 flex items-center justify-center bg-gray-50">
               <!-- Vertical text or just empty space -->
            </div>
          </section>
        </as-split-area>

        <!-- Editor and Terminal Section -->
        <as-split-area [size]="mainSplitSizes[1]">
          <as-split direction="vertical" (dragEnd)="onSplitDragEnd()" [gutterSize]="8">
            <!-- Editor Section -->
            <as-split-area [size]="rightSplitSizes[0]" [minSize]="6">
              <section class="flex flex-col h-full bg-white border border-[#e3e7ed] rounded-xl overflow-hidden">
                <div class="flex bg-[#f7f8fa] border-b border-[#e3e7ed] text-sm font-semibold shrink-0 items-center justify-between pr-2">
                  <span class="px-5 py-2 text-[#293146] flex items-center gap-2 tracking-wide" [class.hidden]="isEditorCollapsed()">
                    solution.ts
                  </span>
                  <button
                    (click)="toggleEditor()"
                    class="p-1 hover:bg-gray-200 rounded transition-colors cursor-pointer text-gray-500"
                    [title]="isEditorCollapsed() ? 'Expand' : 'Collapse'"
                  >
                    <span class="text-lg">{{ isEditorCollapsed() ? '↓' : '↑' }}</span>
                  </button>
                </div>
                <div class="flex-1 min-h-0" [class.hidden]="isEditorCollapsed()">
                  <ngx-monaco-editor
                    [options]="editorOptions"
                    [(ngModel)]="code"
                    (onInit)="onEditorInit($event)"
                    style="height: 100%"
                  ></ngx-monaco-editor>
                </div>
              </section>
            </as-split-area>

            <!-- Terminal / Test cases Section -->
            <as-split-area [size]="rightSplitSizes[1]" [minSize]="6">
              <section class="flex flex-col h-full bg-white border border-[#e3e7ed] rounded-xl overflow-hidden">
                <div class="flex bg-[#f7f8fa] border-b border-[#e3e7ed] text-sm font-semibold shrink-0 items-center justify-between pr-2">
                  <span class="px-5 py-2 text-[#293146] flex items-center gap-2 tracking-wide" [class.hidden]="isTerminalCollapsed()">
                    Test cases
                  </span>
                  <button
                    (click)="toggleTerminal()"
                    class="p-1 hover:bg-gray-200 rounded transition-colors cursor-pointer text-gray-500"
                    [title]="isTerminalCollapsed() ? 'Expand' : 'Collapse'"
                  >
                    <span class="text-lg">{{ isTerminalCollapsed() ? '↑' : '↓' }}</span>
                  </button>
                </div>
                <div
                  *ngIf="!isTerminalCollapsed()"
                  class="flex-1 min-h-0 py-3 px-4 text-[#293146] rounded-b-xl"
                >
                  test cases content
                </div>
              </section>
            </as-split-area>
          </as-split>
        </as-split-area>
      </as-split>
    </main>
  </div>
</div>
